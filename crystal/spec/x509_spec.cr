require "./spec_helper"

X509_PRIVATE_PEM = <<-PEM
-----BEGIN PRIVATE KEY-----
MIIJQgIBADANBgkqhkiG9w0BAQEFAASCCSwwggkoAgEAAoICAQC7pju+F08rD6fy
+L8FKox804cmrXWhYmDHamsMCKsksYwFmA2HXI/1s72CR8E28q+EkhqPalv2sgOt
c3/wHqdZcmoTrh96pU3pzJY2ZwYrDXZCGoUiD1oS4F43YPg6ESDPL21iUhDrfn+J
vDvS+9JFwMzPGZUbyXH/lXNb+n09rXMSoRS6Sh4p9V8asAnfm/+/Z5exH3VZt4HZ
VO3TOyGOinKA1WjsGm0Xlgre41uAFTU5IpxJgV4FljuGvFT5qgjY8cBQbO+l/AWp
ih1u/jeR2kVoTxRJ9g6QIMsD7f9LpK4UnCPGLzMoCkdWBfvCL2X/d05nD7zAOxZw
TdDtoGJdJYhwzQyySEqnM2k6FVqUun7qVhjNGt0YdOY23lYlMzZYZApcok2n644f
BKaOAphBgbfOkehFjNkTeCCWu7V+nQceXqj1j4IU+R7x1L8eB8jYoaLPQFlhCQlu
3uv7cgwrefaVEidj/J16L1P8kpZ2H2ILqeSw4daWs204RYK8eoY/QiXvxw5bCR3P
RqTuX5JvgYqo+Gr91cC40IbQHUDWg6So0TxVC4oS837Cr7YSlFeZgi7jQPd2LSzY
nQjAWCtXoMSaLkZxQXOlc/NPr3Fmsa2PsFW1A+Ny15iAZlGc7v0hy+HsoArH3pHO
l7jpkbJc+8+Dow5q33AsNaZOkLgnTQIDAQABAoICAAYaMZKsuOEeXPiYkMO2/sMX
cOt31B23sIyDoDAPvxsOIA7Vg0kd4DueCQFp2nVyPnV5992mmI+E+fwjx6sUIB6X
Sy5RKQpowkgiZFcoEgoH4crkCGTTaXs4KzAzWdcvk+jQ8sZyA0VZQ4YD5lEl6dBl
ZPOuMgxpiGjGoC4DTxvYnmeib+VgACuepGVeiK+qJ86+bG8w5fTRNCqQabyHDYAQ
bglVB1i4Qkh0U22sqJ7ZcbXmM31rdNaLLGvlB4Fn/2oosHedF00HTVrWWD8yCrYW
SlAKVE9UbmRPALMjw/vegt++NSaehdQdQ3UfdDC8MF22sEjHOPzqXwAvc6Yqo1A0
Y518vAmYn6z9Za6p/QXlVUVgdKavsw3ZmqbwWUK6D0/3+NdrxfJqWbsij+K9vZTF
xe9+UQ2KLzYfOlgYribCQ0r2XKYxRz3dgLFl+MmRbjJMG+pa9LzXHcEYUD9I0DUv
zqp3ED4YDQkB8VNYCPvvEjZ83CY6puLB2nPT2PFWQ3DASKQsgddETP7+wZjwHPmc
Z0QGUqV0VZQf+xLUEdkG7/3EM3TSjDwFDzwQ4aZ0IK39I6WEWqHtpgqrry/5YeGR
ANfYJ7IU9zxA4td9nCrXSFiKFkGFkir8iIkdRbAqjcJuR4UzB1vpDCOeURhS6/ta
EWtS3bQjKYMRa15y282ZAoIBAQDhnRWBrhvQCCvarn3UPrlZvJ6fzbEkVuZQJS4s
ZTl31no+7LDYFPZyPMNCQ/edzZdle6Jr6U4Y4fequuWbkyrKEpjToF/Z+kFBM6me
FUeKcfvhC1SUkRHURs1bEV9mCv/DQBcOr6Oqo3y5OkbRoK7hPDA5FJFiyDbN/MOM
qTWJrdwv8xxnoHIHObLgPytQlVpFal6E+t1/TB0BFq9HTDyDkgo44b/aDPdRiGHb
3M3TWog6l7JIC42Cl093pCTIpJdYx4gXfJnpbUpq92Y6nRGCVLZurIdz3VrrCUdB
v/2RR8an8Zwh2eyKyyWca96qrR8idl6/+60yve3OPK1hPpNVAoIBAQDU7C6oqumh
spFRvfDvb8XVjZGu5x/ifuw/DzmkjdhTE/NAYBQoeCcQIzSBfT9Dc06/oTBpjm8X
YnyYGWiSXaw17PUNrX/TkVvuoCFtBjQI6fLY49FpQZ9P1dq2eOmTSaGqx2VkWPPJ
BvxaV+V1AaxzMSvSCA6Vagj2cNMZJr2KFOTzdiBhUcUTRsgjLkZC63V2o1jxx+YV
SbOdzkNaLveJkyaLeXrqyvdDCghJgfaN3NUApSLbxm2pmMVEhTsCC6rDmaG/4Pcg
IdYM92weqAPufcatKQ9QVr7NiVmJnHhy8rUxk/JgCM4Qxk9RwoAa2CosfzRJrhy7
yHfEqUcR9LQZAoIBABSlGCu2r+rYZJLtNqxuVO2mOemrm9MUdJzO2ivL03do0+Tg
KcqMGIUZlFCDAayZ/ImXx6QSREg4nT4tPgd/bwHws7VhzoOWx9Pck1/Y2KQNjBvq
uoGhyLzhAbecnlsrFH5cZf+9CL/7l9UnRQW3q2kG5e7DOA6O/ZzZzVcYwMJpe2WT
3HyLDQQmPn0QqrkEAa+qbR3ECvK0F09bMQzYKA1uFqtf1PtyBkuarEG/McJuXVrn
OLQpAnj5uZbcGVWW4haIo6Zqi3b1vkKNgvhIGSsQ72SvOvHaRpCNV8zncZ+SrtX9
YOkkFOYacsWehVCe6ONxa3gr4oxrHtCpcsAcRsUCggEAVdvDWNpKiZyTAs4/6J0+
vkVu+INUlSWvKCKAkP1tvNpvnYbgugzxW42Gr6yMpStLFvTtq7L20wwwx7h/NX42
YixiCJjs0ahs1MWXlPoKY4nLFnCPUg1XK39FyYzqSy1G1rG/Df7clzSM7/U/nrYF
DxJF5FTBZLi0UoPea+b2SUbxp8b7eaLagFJrg9w2EugVnrhxtlVwTydAGaNB/4yu
3rgKs/VRfnpHyK2z98hDXqMs9Syh6NOUBu6GpYG/8Kw5uNQrqE8T984NHX9sBtSj
eTkYs1y6QyAnooP/KgGBhICgVhSdiOIkDhmZhJOUyr5eC0FkGU3vYj2NJi1IblIp
iQKCAQEAihMmMGrz9YeZWuBziAyDmC8SDiAAKIQWCpWCdRASjDAuwaaiH7vda2f3
9+Zn2Dqv96BSQxoSk68danLWVZi5bGnv5KGI66peLq6XK8zdEqMmC/b/cLSmgGqu
KZaARjx1X+kHHZyFP5iKFzP5dE9UwQnmkECWlpyLG27C2Ut50EfxvWW7wSGulImn
6wwjtO00pDi7R1UqixalL+cd3zp3nTIcA/GyX2KmTcweiX2BfhD5/ifxUROc2hbn
bfXivTL2PSLfwqHU/0h2bpA7PrHyK5Y0gwqe+JBB/mhIRP3szjLFLSZaKAODKY7Q
FrkgYHbmRVPfZz/qWOd/Oet5vJ6oQg==
-----END PRIVATE KEY-----

PEM
X509_PUBLIC_PEM = <<-PEM
-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAu6Y7vhdPKw+n8vi/BSqM
fNOHJq11oWJgx2prDAirJLGMBZgNh1yP9bO9gkfBNvKvhJIaj2pb9rIDrXN/8B6n
WXJqE64feqVN6cyWNmcGKw12QhqFIg9aEuBeN2D4OhEgzy9tYlIQ635/ibw70vvS
RcDMzxmVG8lx/5VzW/p9Pa1zEqEUukoeKfVfGrAJ35v/v2eXsR91WbeB2VTt0zsh
jopygNVo7BptF5YK3uNbgBU1OSKcSYFeBZY7hrxU+aoI2PHAUGzvpfwFqYodbv43
kdpFaE8USfYOkCDLA+3/S6SuFJwjxi8zKApHVgX7wi9l/3dOZw+8wDsWcE3Q7aBi
XSWIcM0MskhKpzNpOhValLp+6lYYzRrdGHTmNt5WJTM2WGQKXKJNp+uOHwSmjgKY
QYG3zpHoRYzZE3gglru1fp0HHl6o9Y+CFPke8dS/HgfI2KGiz0BZYQkJbt7r+3IM
K3n2lRInY/ydei9T/JKWdh9iC6nksOHWlrNtOEWCvHqGP0Il78cOWwkdz0ak7l+S
b4GKqPhq/dXAuNCG0B1A1oOkqNE8VQuKEvN+wq+2EpRXmYIu40D3di0s2J0IwFgr
V6DEmi5GcUFzpXPzT69xZrGtj7BVtQPjcteYgGZRnO79Icvh7KAKx96Rzpe46ZGy
XPvPg6MOat9wLDWmTpC4J00CAwEAAQ==
-----END PUBLIC KEY-----

PEM
X509_PUBLIC_DER = Bytes[48, 130, 2, 34, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1, 5, 0, 3, 130, 2, 15, 0, 48, 130, 2, 10, 2, 130, 2, 1, 0, 187, 166, 59, 190, 23, 79, 43, 15, 167, 242, 248, 191, 5, 42, 140, 124, 211, 135, 38, 173, 117, 161, 98, 96, 199, 106, 107, 12, 8, 171, 36, 177, 140, 5, 152, 13, 135, 92, 143, 245, 179, 189, 130, 71, 193, 54, 242, 175, 132, 146, 26, 143, 106, 91, 246, 178, 3, 173, 115, 127, 240, 30, 167, 89, 114, 106, 19, 174, 31, 122, 165, 77, 233, 204, 150, 54, 103, 6, 43, 13, 118, 66, 26, 133, 34, 15, 90, 18, 224, 94, 55, 96, 248, 58, 17, 32, 207, 47, 109, 98, 82, 16, 235, 126, 127, 137, 188, 59, 210, 251, 210, 69, 192, 204, 207, 25, 149, 27, 201, 113, 255, 149, 115, 91, 250, 125, 61, 173, 115, 18, 161, 20, 186, 74, 30, 41, 245, 95, 26, 176, 9, 223, 155, 255, 191, 103, 151, 177, 31, 117, 89, 183, 129, 217, 84, 237, 211, 59, 33, 142, 138, 114, 128, 213, 104, 236, 26, 109, 23, 150, 10, 222, 227, 91, 128, 21, 53, 57, 34, 156, 73, 129, 94, 5, 150, 59, 134, 188, 84, 249, 170, 8, 216, 241, 192, 80, 108, 239, 165, 252, 5, 169, 138, 29, 110, 254, 55, 145, 218, 69, 104, 79, 20, 73, 246, 14, 144, 32, 203, 3, 237, 255, 75, 164, 174, 20, 156, 35, 198, 47, 51, 40, 10, 71, 86, 5, 251, 194, 47, 101, 255, 119, 78, 103, 15, 188, 192, 59, 22, 112, 77, 208, 237, 160, 98, 93, 37, 136, 112, 205, 12, 178, 72, 74, 167, 51, 105, 58, 21, 90, 148, 186, 126, 234, 86, 24, 205, 26, 221, 24, 116, 230, 54, 222, 86, 37, 51, 54, 88, 100, 10, 92, 162, 77, 167, 235, 142, 31, 4, 166, 142, 2, 152, 65, 129, 183, 206, 145, 232, 69, 140, 217, 19, 120, 32, 150, 187, 181, 126, 157, 7, 30, 94, 168, 245, 143, 130, 20, 249, 30, 241, 212, 191, 30, 7, 200, 216, 161, 162, 207, 64, 89, 97, 9, 9, 110, 222, 235, 251, 114, 12, 43, 121, 246, 149, 18, 39, 99, 252, 157, 122, 47, 83, 252, 146, 150, 118, 31, 98, 11, 169, 228, 176, 225, 214, 150, 179, 109, 56, 69, 130, 188, 122, 134, 63, 66, 37, 239, 199, 14, 91, 9, 29, 207, 70, 164, 238, 95, 146, 111, 129, 138, 168, 248, 106, 253, 213, 192, 184, 208, 134, 208, 29, 64, 214, 131, 164, 168, 209, 60, 85, 11, 138, 18, 243, 126, 194, 175, 182, 18, 148, 87, 153, 130, 46, 227, 64, 247, 118, 45, 44, 216, 157, 8, 192, 88, 43, 87, 160, 196, 154, 46, 70, 113, 65, 115, 165, 115, 243, 79, 175, 113, 102, 177, 173, 143, 176, 85, 181, 3, 227, 114, 215, 152, 128, 102, 81, 156, 238, 253, 33, 203, 225, 236, 160, 10, 199, 222, 145, 206, 151, 184, 233, 145, 178, 92, 251, 207, 131, 163, 14, 106, 223, 112, 44, 53, 166, 78, 144, 184, 39, 77, 2, 3, 1, 0, 1]
alias RSA = OpenSSL::PKey::RSA

describe "x509" do
  it "converts private key" do
    pkey = RSA.new X509_PRIVATE_PEM
    pkey.x509_public.should eq X509_PUBLIC_DER
  end
  it "converts public key" do
    pkey = RSA.new X509_PUBLIC_PEM
    pkey.x509_public.should eq X509_PUBLIC_DER
  end
end
